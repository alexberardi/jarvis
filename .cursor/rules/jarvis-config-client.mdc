---
description: Rules for jarvis-config-client - service discovery library
globs: jarvis-config-client/**
---

# jarvis-config-client

Python library for service discovery. Fetches service URLs from jarvis-config-service.

## Setup & Run

```bash
pip install -e .
pytest
```

## Usage

```python
from jarvis_config_client import init, get_service_url

init(config_url="http://localhost:7700")
auth_url = get_service_url("jarvis-auth")
logs_url = get_service_url("jarvis-logs")
```

With database persistence:
```python
from sqlalchemy import create_engine
engine = create_engine("postgresql://...")
init(config_url="http://localhost:7700", db_engine=engine)
```

## Architecture

```
jarvis_config_client/
├── __init__.py    # Public API
└── client.py      # Core client with caching and refresh
```

## Service Dependencies

Talks to its respective service only:
- `jarvis-config-service` (7700) - Fetches service URLs (GET /services)

## Features

- In-memory caching of service URLs
- Optional PostgreSQL/SQLite persistence
- Background refresh every 5 minutes
- Fallback to cached values on failure
- Thread-safe
